@{
    ViewData["Title"] = "Home Page";
    var saloniPopolari = ViewBag.SaloniPopolari as IEnumerable<dynamic> ?? new List<dynamic>();
}

@section Styles{
    <link href="~/css/Clienti.css" rel="stylesheet" />
    <style>
        /* Aggiungi stili per i nuovi elementi */
        .promo-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
            animation: pulse 2s infinite;
        }

        .premium-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .salon-image {
            position: relative;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .service-tag.more {
            background-color: #e5e7eb;
            color: #6b7280;
            font-size: 0.75rem;
        }

        /* Skeleton loading styles */
        .skeleton-card {
            pointer-events: none;
        }

        .skeleton-loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
        }

        .skeleton-text {
            display: block;
            border-radius: 4px;
        }

        @@keyframes loading {
            0%

        {
            background-position: 200% 0;
        }

        100% {
            background-position: -200% 0;
        }

        }

        @@keyframes pulse {
            0%, 100%

        {
            opacity: 1;
        }

        50% {
            opacity: 0.8;
        }

        }

        /* Filtri responsive */
        @@media (max-width: 768px) {
            .filters

        {
            flex-wrap: wrap;
            gap: 8px;
        }

        .filter-btn {
            font-size: 0.875rem;
            padding: 8px 12px;
        }

        }

        .salons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            align-items: stretch;
        }

        .salon-card {
            display: grid;
            grid-template-rows: 200px 1fr;
            height: 100%;
            /* Rimuovi questa transizione che può causare conflitti */
        }

            /* Aggiungi una classe per le card nascoste invece di usare display: none */
            .salon-card.hidden {
                display: none !important;
            }

        .salon-image {
            grid-row: 1;
            height: 200px;
            overflow: hidden; /* Aggiungi questo per evitare overflow delle immagini */
        }

        .salon-info {
            grid-row: 2;
            display: flex;
            flex-direction: column;
            padding: 16px;
        }

        .salon-services {
            flex-grow: 1;
        }

        .salon-footer {
            margin-top: auto;
            padding-top: 16px;
        }
    </style>
}

<!--FORM RICERCA-->
<main class="main-content">
    <div class="container lg:w-3/4 mx-auto">
        <div class="hero">
            <h1>Scopri i migliori saloni vicino a te</h1>
            @* <p>Prenota trattamenti di bellezza, benessere e molto altro con un click</p> *@
        </div>

        <form action="/Search" method="get" class="search-form dark:bg-gray-700" id="homeSearchForm">
            <div class="form-row">
                <div class="form-group">
                    <label for="service" class="dark:text-white">Che servizio stai cercando?</label>
                    <input type="text" id="service" name="q" placeholder="Es. Taglio capelli, Manicure, Massaggio">
                </div>
                <div class="form-group">
                    <label for="location" class="dark:text-white">Dove?</label>
                    <input type="text" id="location" name="location" placeholder="Città, quartiere o codice postale">
                </div>
                <div class="form-group">
                    <label for="date" class="dark:text-white">Quando?</label>
                    <input type="date" id="date" name="data" min="@DateTime.Now.ToString("yyyy-MM-dd")">
                </div>
                <button type="submit" class="search-btn mb-1">Cerca</button>
            </div>
        </form>
    </div>
</main>
<!--CARD SALONI-->
<section class="salons-section dark:bg-gray-800/80">
    <div class="container lg:w-3/4 mx-auto">
        <h2 class="section-title dark:text-gray-300">Saloni popolari nella tua zona</h2>

        <div class="filters">
            <button class="filter-btn active" onclick="filterSalons('tutti')">Tutti</button>
            <button class="filter-btn" onclick="filterSalons('parrucchieri')">Parrucchieri</button>
            <button class="filter-btn" onclick="filterSalons('centri-estetici')">Centri Estetici</button>
            <button class="filter-btn" onclick="filterSalons('spa-benessere')">Spa & Benessere</button>
            <button class="filter-btn" onclick="filterSalons('barbieri')">Barbieri</button>
            <button class="filter-btn" onclick="filterSalons('nail-salon')">Nail Salon</button>
        </div>

        <div class="salons-grid" id="salonsGrid">
            @if (saloniPopolari.Any())
            {
                @foreach (var salone in saloniPopolari)
                {
                    <a href="/Search/Details/@salone.SaloneId">
                        <div class="salon-card" data-category="@GetSalonCategory(salone.ServiziPopolari)">
                            <div class="salon-image">
                                @if (!string.IsNullOrEmpty(salone.CoverImageUrl))
                                {
                                    <img src="@salone.CoverImageUrl"
                                         alt="@salone.Nome"
                                         class="w-full h-full object-cover">
                                }
                                else
                                {
                                    <div class="w-full h-full bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 flex items-center justify-center">
                                        <i class="fas fa-store text-6xl text-white/80"></i>
                                    </div>
                                }
                                @if (salone.HasPromozioni)
                                {
                                    <div class="promo-badge">OFFERTE</div>
                                }
                                @if (salone.IsPremium)
                                {
                                    <div class="premium-badge">PREMIUM</div>
                                }
                            </div>
                            <div class="salon-info">
                                <div class="salon-header">
                                    <div>
                                        <h3 class="salon-name">@salone.Nome</h3>
                                        <div class="salon-location">
                                            📍 @salone.Citta, @salone.Provincia
                                        </div>
                                    </div>
                                    <div class="salon-rating">
                                        <span class="stars">@GetStarsDisplay(salone.MediaVoti)</span>
                                        <span class="rating-text">@salone.VotiDisplay @(salone.NumeroRecensioni > 0 ? $"({salone.NumeroRecensioni})" : "")</span>
                                    </div>
                                </div>
                                <div class="salon-services">
                                    <div class="services-title">Servizi</div>
                                    <div class="services-list">
                                        @if (salone.ServiziPopolari.Count > 0)
                                        {
                                            @foreach (var servizio in ((List<string>)salone.ServiziPopolari).Take(4))
                                            {
                                                <span class="service-tag">@servizio</span>
                                            }
                                            @if (salone.NumeroServizi > 4)
                                            {
                                                <span class="service-tag more">+@(salone.NumeroServizi - 4) altri</span>
                                            }
                                        }
                                        else
                                        {
                                            <span class="service-tag">Vari servizi</span>
                                        }
                                    </div>
                                </div>
                                <div class="salon-footer">
                                    <span class="price-range">@salone.PrezzoRange</span>
                                    <button class="book-btn" onclick="location.href='/Search/Details/@salone.SaloneId'">Prenota ora</button>
                                </div>
                            </div>
                        </div>
                    </a>
                }
            }
            else
            {
                <!-- Fallback con skeleton loading -->
                @for (int i = 0; i < 6; i++)
                {
                    <div class="salon-card skeleton-card">
                        <div class="salon-image skeleton-loading"></div>
                        <div class="salon-info">
                            <div class="salon-header">
                                <div>
                                    <div class="skeleton-text skeleton-loading" style="width: 70%; height: 20px; margin-bottom: 8px;"></div>
                                    <div class="skeleton-text skeleton-loading" style="width: 50%; height: 16px;"></div>
                                </div>
                                <div class="salon-rating">
                                    <div class="skeleton-text skeleton-loading" style="width: 80px; height: 16px;"></div>
                                </div>
                            </div>
                            <div class="salon-services">
                                <div class="skeleton-text skeleton-loading" style="width: 40%; height: 16px; margin-bottom: 8px;"></div>
                                <div class="services-list">
                                    <div class="skeleton-text skeleton-loading service-tag" style="width: 60px;"></div>
                                    <div class="skeleton-text skeleton-loading service-tag" style="width: 80px;"></div>
                                    <div class="skeleton-text skeleton-loading service-tag" style="width: 70px;"></div>
                                </div>
                            </div>
                            <div class="salon-footer">
                                <div class="skeleton-text skeleton-loading" style="width: 60px; height: 16px;"></div>
                                <div class="skeleton-text skeleton-loading" style="width: 80px; height: 32px;"></div>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>

        @if (saloniPopolari.Any())
        {
            <div class="text-center mt-8">
                <a href="/Search" class="inline-flex items-center px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors">
                    <i class="fas fa-search mr-2"></i>
                    Esplora tutti i saloni
                    <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        }
    </div>
</section>

<!--SEZIONE ILLUSTRATIVA PER POTENZIALI PARTNER-->
<div class="bg-gray-50 py-24 sm:py-32 dark:bg-gray-700/80">
    <div class="mx-auto max-w-2xl px-6 lg:max-w-7xl lg:px-8">
        <h2 class="text-center text-base/7 font-semibold text-purple-600">Gestisci il tuo salone</h2>
        <p class="mx-auto mt-2 max-w-lg text-center text-4xl font-semibold tracking-tight text-balance text-gray-950 sm:text-5x dark:text-gray-300">Tutto quello che serve per la tua attività</p>
        <div class="mt-10 grid gap-4 sm:mt-16 lg:grid-cols-3 lg:grid-rows-2">
            <div class="relative lg:row-span-2">
                <div class="absolute inset-px rounded-lg bg-white lg:rounded-l-4xl"></div>
                <div class="relative flex h-full flex-col overflow-hidden rounded-[calc(var(--radius-lg)+1px)] lg:rounded-l-[calc(2rem+1px)]">
                    <div class="px-8 pt-8 pb-3 sm:px-10 sm:pt-10 sm:pb-0">
                        <p class="mt-2 text-lg font-medium tracking-tight text-gray-950 max-lg:text-center">Prenotazioni 24/7</p>
                        <p class="mt-2 max-w-lg text-sm/6 text-gray-600 max-lg:text-center">I tuoi clienti possono prenotare in qualsiasi momento dal loro smartphone, anche fuori orario.</p>
                    </div>
                    <div class="@@container relative min-h-120 w-full grow max-lg:mx-auto max-lg:max-w-sm">
                        <div class="absolute inset-x-10 top-10 bottom-0 overflow-hidden rounded-t-3xl border-x-[0.5em] border-t-[0.5em] border-gray-700 bg-gray-900 shadow-2xl">
                            <img class="size-full object-cover object-top" src="/img/calendario.jpg" alt="">
                        </div>
                    </div>
                </div>
                <div class="pointer-events-none absolute inset-px rounded-lg shadow-sm ring-1 ring-black/5 lg:rounded-l-4xl"></div>
            </div>
            <div class="relative max-lg:row-start-1">
                <div class="absolute inset-px rounded-lg bg-white max-lg:rounded-t-4xl"></div>
                <div class="relative flex h-full flex-col overflow-hidden rounded-[calc(var(--radius-lg)+1px)] max-lg:rounded-t-[calc(2rem+1px)]">
                    <div class="px-8 pt-8 sm:px-10 sm:pt-10">
                        <p class="mt-2 text-lg font-medium tracking-tight text-gray-950 max-lg:text-center">Calendario Intelligente</p>
                        <p class="mt-2 max-w-lg text-sm/6 text-gray-600 max-lg:text-center">Gestisci appuntamenti, staff e servizi in un'unica dashboard intuitiva e veloce.</p>
                    </div>
                    <div class="flex flex-1 items-center justify-center px-8 max-lg:pt-10 max-lg:pb-12 sm:px-10 lg:pb-2">
                        <img class="max-lg:max-w-xs h-[min(152px,40cqw)] object-cover w-full rounded object-top" src="https://images.unsplash.com/photo-1562217180-021f74991332?q=80&w=2670&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="">
                    </div>
                </div>
                <div class="pointer-events-none absolute inset-px rounded-lg shadow-sm ring-1 ring-black/5 max-lg:rounded-t-4xl"></div>
            </div>
            <div class="relative max-lg:row-start-3 lg:col-start-2 lg:row-start-2">
                <div class="absolute inset-px rounded-lg bg-white"></div>
                <div class="relative flex h-full flex-col overflow-hidden rounded-[calc(var(--radius-lg)+1px)]">
                    <div class="px-8 pt-8 sm:px-10 sm:pt-10">
                        <p class="mt-2 text-lg font-medium tracking-tight text-gray-950 max-lg:text-center">Gestione Clienti</p>
                        <p class="mt-2 max-w-lg text-sm/6 text-gray-600 max-lg:text-center">Storico trattamenti, preferenze e promemoria automatici per fidelizzare la tua clientela.</p>
                    </div>
                    <div class="px-8 max-lg:pt-10 max-lg:pb-12 pt-4 pb-5 sm:px-10">
                        <img class="h-[min(152px,40cqw)] object-cover w-full rounded" src="https://images.unsplash.com/photo-1608222351212-18fe0ec7b13b?q=80&w=2574&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="">
                    </div>
                </div>
                <div class="pointer-events-none absolute inset-px rounded-lg shadow-sm ring-1 ring-black/5"></div>
            </div>
            <div class="relative lg:row-span-2">
                <div class="absolute inset-px rounded-lg bg-white max-lg:rounded-b-4xl lg:rounded-r-4xl"></div>
                <div class="relative flex h-full flex-col overflow-hidden rounded-[calc(var(--radius-lg)+1px)] max-lg:rounded-b-[calc(2rem+1px)] lg:rounded-r-[calc(2rem+1px)]">
                    <div class="px-8 pt-8 pb-3 sm:px-10 sm:pt-10 sm:pb-0">
                        <p class="mt-2 text-lg font-medium tracking-tight text-gray-950 max-lg:text-center">Automazioni Smart</p>
                        <p class="mt-2 max-w-lg text-sm/6 text-gray-600 max-lg:text-center">Conferme automatiche, reminder SMS e sincronizzazione con i tuoi strumenti preferiti.</p>
                    </div>
                    <div class="relative min-h-120 w-full grow">
                        <div class="absolute top-10 right-0 bottom-0 left-10 overflow-hidden rounded-tl-xl bg-gray-900 shadow-2xl">
                            <img class="size-full object-cover" src="/img/notifiche.png" alt="notifiche" />
                        </div>
                    </div>
                </div>
                <div class="pointer-events-none absolute inset-px rounded-lg shadow-sm ring-1 ring-black/5 max-lg:rounded-b-4xl lg:rounded-r-4xl"></div>
            </div>
        </div>
    </div>
</div>
<!-- CTA PER I PARTNER-->
<div class="bg-white dark:bg-gray-800/80">
    <div class="mx-auto max-w-7xl py-24 sm:px-6 sm:py-32 lg:px-8">
        <div class="relative isolate overflow-hidden bg-gray-900 px-6 pt-16 shadow-2xl sm:rounded-3xl sm:px-16 md:pt-24 lg:flex lg:gap-x-20 lg:px-24 lg:pt-0">
            <svg viewBox="0 0 1024 1024" class="absolute top-1/2 left-1/2 -z-10 size-256 -translate-y-1/2 mask-[radial-gradient(closest-side,white,transparent)] sm:left-full sm:-ml-80 lg:left-1/2 lg:ml-0 lg:-translate-x-1/2 lg:translate-y-0" aria-hidden="true">
                <circle cx="512" cy="512" r="512" fill="url(#759c1415-0410-454c-8f7c-9a820de03641)" fill-opacity="0.7" />
                <defs>
                    <radialGradient id="759c1415-0410-454c-8f7c-9a820de03641">
                        <stop stop-color="#7775D6" />
                        <stop offset="1" stop-color="#E935C1" />
                    </radialGradient>
                </defs>
            </svg>
            <div class="mx-auto max-w-md text-center lg:mx-0 lg:flex-auto lg:py-32 lg:text-left">
                <h2 class="text-3xl font-semibold tracking-tight text-balance text-white sm:text-4xl">Prova gratis per 14 giorni.</h2>
                <p class="mt-6 text-lg/8 text-pretty text-gray-300">Il nostro sistema gestisce automaticamente calendari, promemoria e pagamenti, mentre tu ti concentri sui tuoi clienti.</p>
                <div class="mt-10 flex items-center justify-center gap-x-6 lg:justify-start">
                    <a href="/Home/ForPartner" class="rounded-md bg-white px-3.5 py-2.5 text-sm font-semibold text-gray-900 shadow-xs hover:bg-gray-100 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white">Diventa nostro partner</a>
                </div>
            </div>
            <div class="relative mt-16 h-80 lg:mt-8">
                <img class="absolute top-0 left-0 w-228 max-w-none rounded-md bg-white/5 ring-1 ring-white/10" src="https://tailwindcss.com/plus-assets/img/component-images/dark-project-app-screenshot.png" alt="App screenshot" width="1824" height="1080">
            </div>
        </div>
    </div>
</div>

@functions {
    string GetStarsDisplay(double rating)
    {
        if (rating == 0) return "☆☆☆☆☆";

        string stars = "";
        int fullStars = (int)Math.Floor(rating);
        bool hasHalfStar = (rating - fullStars) >= 0.5;

        for (int i = 0; i < fullStars; i++)
        {
            stars += "★";
        }

        if (hasHalfStar && fullStars < 5)
        {
            stars += "☆"; // Mezza stella rappresentata come stella vuota
            fullStars++;
        }

        for (int i = fullStars; i < 5; i++)
        {
            stars += "☆";
        }

        return stars;
    }

    string GetSalonCategory(List<string> servizi)
    {
        if (servizi == null || !servizi.Any()) return "generale";

        var serviziLower = servizi.Select(s => s.ToLower()).ToList();
        var tuttiServizi = string.Join(" ", serviziLower);

        // Controlli più specifici con priorità
        if (serviziLower.Any(s => s.Contains("barba") || s.Contains("barbiere")) ||
            tuttiServizi.Contains("barba") || tuttiServizi.Contains("barbiere"))
            return "barbieri";

        if (serviziLower.Any(s => s.Contains("manicure") || s.Contains("pedicure") || s.Contains("unghie") || s.Contains("nail")) ||
            tuttiServizi.Contains("nail"))
            return "nail-salon";

        if (serviziLower.Any(s => s.Contains("massaggio") || s.Contains("spa") || s.Contains("benessere") || s.Contains("relax") || s.Contains("wellness")) ||
            tuttiServizi.Contains("massaggio") || tuttiServizi.Contains("spa"))
            return "spa-benessere";

        if (serviziLower.Any(s => s.Contains("taglio") || s.Contains("capelli") || s.Contains("piega") || s.Contains("colore") || s.Contains("tinta") || s.Contains("parrucchiere")) ||
            tuttiServizi.Contains("capelli") || tuttiServizi.Contains("parrucchiere"))
            return "parrucchieri";

        if (serviziLower.Any(s => s.Contains("viso") || s.Contains("estetica") || s.Contains("epilazione") || s.Contains("trattamento") || s.Contains("pulizia")) ||
            tuttiServizi.Contains("estetica") || tuttiServizi.Contains("trattamento"))
            return "centri-estetici";

        return "generale";
    }
}

<script>
    // Script per migliorare l'esperienza utente
    document.addEventListener('DOMContentLoaded', function() {
        const searchForm = document.getElementById('homeSearchForm');
        const serviceInput = document.getElementById('service');
        const locationInput = document.getElementById('location');
        const dateInput = document.getElementById('date');

        // Auto-suggest per servizi
        let searchTimeout;
        serviceInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            const query = this.value.trim();

            if (query.length >= 2) {
                searchTimeout = setTimeout(() => {
                    // Chiamata per suggerimenti servizi
                    fetch(`/Search/Suggestions?q=${encodeURIComponent(query)}&limit=5`)
                        .then(response => response.json())
                        .then(data => {
                            showSuggestions(data.suggestions, serviceInput);
                        })
                        .catch(error => console.log('Errore suggerimenti:', error));
                }, 300);
            }
        });

        // Geolocalizzazione per il campo location
        if ("geolocation" in navigator) {
            const geoButton = document.createElement('button');
            geoButton.type = 'button';
            geoButton.className = 'absolute right-2 top-1/2 transform -translate-y-1/2 text-purple-600 hover:text-purple-700';
            geoButton.innerHTML = '<i class="fas fa-location-arrow"></i>';
            geoButton.title = 'Usa la mia posizione';

            locationInput.parentElement.style.position = 'relative';
            locationInput.parentElement.appendChild(geoButton);

            geoButton.addEventListener('click', function() {
                this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        // Geocoding inverso (richiederebbe un servizio)
                        locationInput.value = 'Posizione corrente';
                        geoButton.innerHTML = '<i class="fas fa-check text-green-600"></i>';
                        setTimeout(() => {
                            geoButton.innerHTML = '<i class="fas fa-location-arrow"></i>';
                        }, 2000);
                    },
                    function(error) {
                        geoButton.innerHTML = '<i class="fas fa-exclamation-triangle text-red-600"></i>';
                        setTimeout(() => {
                            geoButton.innerHTML = '<i class="fas fa-location-arrow"></i>';
                        }, 2000);
                    }
                );
            });
        }

        // Validazione form
        searchForm.addEventListener('submit', function(e) {
            const service = serviceInput.value.trim();
            const location = locationInput.value.trim();

            if (!service && !location) {
                e.preventDefault();
                alert('Inserisci almeno un servizio o una località per la ricerca');
                return false;
            }
        });

        // Imposta data di default a domani
        if (!dateInput.value) {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            dateInput.value = tomorrow.toISOString().split('T')[0];
        }
    });

    function showSuggestions(suggestions, inputElement) {
        // Rimuovi suggerimenti esistenti
        const existingSuggestions = document.getElementById('serviceSuggestions');
        if (existingSuggestions) {
            existingSuggestions.remove();
        }

        if (suggestions.length === 0) return;

        // Crea container suggerimenti
        const suggestionsContainer = document.createElement('div');
        suggestionsContainer.id = 'serviceSuggestions';
        suggestionsContainer.className = 'absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg mt-1 max-h-48 overflow-y-auto';

        suggestions.forEach(suggestion => {
            const suggestionItem = document.createElement('div');
            suggestionItem.className = 'p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0';
            suggestionItem.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${suggestion.tipo === 'salone' ? 'fa-store' : 'fa-cut'} text-gray-400 mr-3"></i>
                    <div>
                        <div class="font-medium text-gray-900">${suggestion.nome}</div>
                        <div class="text-sm text-gray-500">${suggestion.location}</div>
                    </div>
                </div>
            `;

            suggestionItem.addEventListener('click', function() {
                inputElement.value = suggestion.nome;
                suggestionsContainer.remove();
            });

            suggestionsContainer.appendChild(suggestionItem);
        });

        // Posiziona i suggerimenti
        inputElement.parentElement.style.position = 'relative';
        inputElement.parentElement.appendChild(suggestionsContainer);

        // Chiudi suggerimenti quando si clicca fuori
        document.addEventListener('click', function closeHandler(e) {
            if (!inputElement.contains(e.target) && !suggestionsContainer.contains(e.target)) {
                suggestionsContainer.remove();
                document.removeEventListener('click', closeHandler);
            }
        });
    }
</script>

<script>
    // Funzione per filtrare i saloni per categoria
        function filterSalons(category) {
        const cards = document.querySelectorAll('.salon-card:not(.skeleton-card)');
        const buttons = document.querySelectorAll('.filter-btn');

        // Reset active button
        buttons.forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');

        cards.forEach((card, index) => {
            const cardCategory = card.getAttribute('data-category');

            // Reset degli stili inline che potrebbero essere stati applicati dalle animazioni
            card.style.display = '';
            card.style.opacity = '';
            card.style.transform = '';
            card.style.transition = '';

            if (category === 'tutti' || cardCategory === category || cardCategory === 'generale') {
                card.classList.remove('hidden');

                // Animazione di entrata
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';

                setTimeout(() => {
                    card.style.transition = 'all 0.3s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 50); // Ridotto il delay per una animazione più fluida
            } else {
                card.classList.add('hidden');
            }
        });

        // Verifica se ci sono risultati
        const visibleCards = Array.from(cards).filter(card => !card.classList.contains('hidden'));
        const grid = document.getElementById('salonsGrid');

        if (visibleCards.length === 0) {
            // Mostra messaggio "nessun risultato"
            if (!document.getElementById('noResultsMessage')) {
                const noResults = document.createElement('div');
                noResults.id = 'noResultsMessage';
                noResults.className = 'col-span-full text-center py-12';
                noResults.innerHTML = `
                    <div class="text-gray-400 dark:text-gray-500">
                        <i class="fas fa-search text-4xl mb-4"></i>
                        <p class="text-lg font-medium">Nessun salone trovato per questa categoria</p>
                        <p class="text-sm">Prova con una categoria diversa</p>
                    </div>
                `;
                grid.appendChild(noResults);
            }
        } else {
            // Rimuovi messaggio "nessun risultato" se presente
            const noResults = document.getElementById('noResultsMessage');
            if (noResults) {
                noResults.remove();
            }
        }
    }

    // Animazione di entrata per le card al caricamento
    document.addEventListener('DOMContentLoaded', function() {
        const cards = document.querySelectorAll('.salon-card:not(.skeleton-card)');

        cards.forEach((card, index) => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';

            setTimeout(() => {
                card.style.transition = 'all 0.6s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 100);
        });

        // Se ci sono skeleton cards, prova a ricaricare i dati dopo 2 secondi
        const skeletonCards = document.querySelectorAll('.skeleton-card');
        if (skeletonCards.length > 0) {
            setTimeout(() => {
                // Ricarica la pagina o fai una chiamata AJAX per ottenere i dati
                location.reload();
            }, 5000);
        }
    });
</script>